!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p=(window.__sw__.assetPath + '/bundles/jblloginascustomer/'),t(t.s="wrlB")}({P8hj:function(e,n,t){"use strict";function o(e,n){for(var t=[],o={},r=0;r<n.length;r++){var i=n[r],s=i[0],l={id:e+":"+r,css:i[1],media:i[2],sourceMap:i[3]};o[s]?o[s].parts.push(l):t.push(o[s]={id:s,parts:[l]})}return t}t.r(n),t.d(n,"default",(function(){return p}));var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},s=r&&(document.head||document.getElementsByTagName("head")[0]),l=null,a=0,c=!1,u=function(){},d=null,f="data-vue-ssr-id",m="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,n,t,r){c=t,d=r||{};var s=o(e,n);return g(s),function(n){for(var t=[],r=0;r<s.length;r++){var l=s[r];(a=i[l.id]).refs--,t.push(a)}n?g(s=o(e,n)):s=[];for(r=0;r<t.length;r++){var a;if(0===(a=t[r]).refs){for(var c=0;c<a.parts.length;c++)a.parts[c]();delete i[a.id]}}}}function g(e){for(var n=0;n<e.length;n++){var t=e[n],o=i[t.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](t.parts[r]);for(;r<t.parts.length;r++)o.parts.push(b(t.parts[r]));o.parts.length>t.parts.length&&(o.parts.length=t.parts.length)}else{var s=[];for(r=0;r<t.parts.length;r++)s.push(b(t.parts[r]));i[t.id]={id:t.id,refs:1,parts:s}}}}function h(){var e=document.createElement("style");return e.type="text/css",s.appendChild(e),e}function b(e){var n,t,o=document.querySelector("style["+f+'~="'+e.id+'"]');if(o){if(c)return u;o.parentNode.removeChild(o)}if(m){var r=a++;o=l||(l=h()),n=_.bind(null,o,r,!1),t=_.bind(null,o,r,!0)}else o=h(),n=w.bind(null,o),t=function(){o.parentNode.removeChild(o)};return n(e),function(o){if(o){if(o.css===e.css&&o.media===e.media&&o.sourceMap===e.sourceMap)return;n(e=o)}else t()}}var v,y=(v=[],function(e,n){return v[e]=n,v.filter(Boolean).join("\n")});function _(e,n,t,o){var r=t?"":o.css;if(e.styleSheet)e.styleSheet.cssText=y(n,r);else{var i=document.createTextNode(r),s=e.childNodes;s[n]&&e.removeChild(s[n]),s.length?e.insertBefore(i,s[n]):e.appendChild(i)}}function w(e,n){var t=n.css,o=n.media,r=n.sourceMap;if(o&&e.setAttribute("media",o),d.ssrId&&e.setAttribute(f,n.id),r&&(t+="\n/*# sourceURL="+r.sources[0]+" */",t+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},"oAp/":function(e,n,t){var o=t("sCub");o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,t("P8hj").default)("08895d2f",o,!0,{})},sCub:function(e,n,t){},wrlB:function(e,n,t){"use strict";t.r(n);var o=Shopware,r=o.Context,i=o.Component,s=o.Mixin,l=Shopware.Data.Criteria;i.register("sw-customer-login-modal",{template:'{% block sw_customer_login_modal %}\n<sw-modal\n        :title="$tc(\'jbl-login-as-customer.modalTitle\')"\n        @modal-close="onClose"\n>\n\n    {% block sw_customer_login_modal_content %}\n\n    {% block sw_customer_login_modal_content_notification %}\n        <sw-alert variant="info">\n            {{ $tc(\'jbl-login-as-customer.infoMessage\') }}\n        </sw-alert>\n    {% endblock %}\n\n        {% block sw_customer_login_modal_content_grid %}\n            <sw-data-grid\n                    ref="salesChannelGrid"\n                    class="sw-customer-login-modal-sales-channel-grid"\n                    :dataSource="salesChannels"\n                    :columns="salesChannelGridColumns"\n                    :showSelection="false"\n                    :isLoading="isLoading"\n                    :compactMode="true"\n                    :showActions="false"\n            >\n\n                <template #column-id="{ item }">\n                    <sw-button size="small" variant="primary" @click="onLogin(item.id, item.domains.first().url)" :isLoading="loginLoading == item.id">\n                        {{ $tc(\'jbl-login-as-customer.buttonSm\') }}\n                    </sw-button>\n                </template>\n\n            </sw-data-grid>\n        {% endblock %}\n    {% endblock %}\n\n    {% block sw_customer_login_modal_footer %}\n    <template slot="modal-footer">\n\n        {% block sw_customer_login_modal_footer_btn_close %}\n            <sw-button size="small" @click="onClose">\n                Close\n            </sw-button>\n\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n</sw-modal>\n{% endblock %}',inject:["repositoryFactory","adminLoginApiService"],mixins:[s.getByName("notification")],props:{customerId:{type:String,required:!0}},data:function(){return{isLoading:!0,loginLoading:null,salesChannels:[]}},computed:{defaultCriteria:function(){var e=new l;return e.addAssociation("domains"),e.addAssociation("type"),e.addFilter(l.equals("active",!0)),e.addFilter(l.equals("type.iconName","regular-storefront")),e},salesChannelRepository:function(){return this.repositoryFactory.create("sales_channel")},salesChannelGridColumns:function(){return[{property:"name",label:"jbl-login-as-customer.gridTitleSalesChannel",useCustomSort:!1,allowResize:!1},{property:"domains.first().url",label:"jbl-login-as-customer.gridTitleDomain",useCustomSort:!1,allowResize:!1},{property:"id",label:"jbl-login-as-customer.gridTitleAction",useCustomSort:!1,allowResize:!1}]}},created:function(){this.createdComponent()},methods:{createdComponent:function(){this.fetchSalesChannels()},fetchSalesChannels:function(){var e=this;this.isLoading=!0,this.salesChannelRepository.search(this.defaultCriteria,r.api).then((function(n){e.salesChannels=n,e.isLoading=!1}))},onLogin:function(e,n){var t=this;this.loginLoading=e,n=n.replace(/^\//,"");this.adminLoginApiService.getToken(this.customerId,e).then((function(e){window.open(n+"/admin-login/"+e.token)})).catch((function(e){t.createNotificationError({title:e.message,message:e.response.data.message})})).finally((function(){t.loginLoading=null}))},onClose:function(){this.$emit("close")}}});t("oAp/");Shopware.Component.override("sw-customer-detail",{template:'{% block sw_customer_detail_actions_edit %}\n\n    {% block sw_customer_detail_actions_login %}\n        <sw-button\n                class="sw-customer-detail__open-login-action"\n                variant="ghost"\n                :disabled="isLoading"\n                @click.prevent="onShowLoginModal(customerId)"\n        >\n            {{ $tc(\'jbl-login-as-customer.buttonLg\') }}\n        </sw-button>\n    {% endblock %}\n\n    {% parent() %}\n{% endblock %}\n\n{% block sw_customer_detail_content_view %}\n    {% parent() %}\n\n    {% block sw_customer_detail_content_view_login_modal %}\n        <sw-customer-login-modal\n                v-if="loginCustomerId"\n                @close="onCloseLoginModal"\n                :customerId="loginCustomerId"\n        ></sw-customer-login-modal>\n    {% endblock %}\n{% endblock %}',data:function(){return{loginCustomerId:null}},methods:{onShowLoginModal:function(e){this.loginCustomerId=e},onCloseLoginModal:function(){this.loginCustomerId=null}}});function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function u(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(r=o.key,i=void 0,i=function(e,n){if("object"!==a(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(r,"string"),"symbol"===a(i)?i:String(i)),o)}var r,i}function d(e,n){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e})(e,n)}function f(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,o=p(e);if(n){var r=p(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return m(this,t)}}function m(e,n){if(n&&("object"===a(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Shopware.Component.override("sw-customer-list",{template:'{% block sw_customer_list_grid_columns_actions_delete %}\n    {% parent() %}\n\n    {% block sw_customer_list_grid_columns_actions_login %}\n        <sw-context-menu-item\n                class="sw-customer-list__login-action"\n                variant="success"\n                @click="onShowLoginModal(item.id)"\n        >\n            {{ $tc(\'jbl-login-as-customer.buttonLg\') }}\n        </sw-context-menu-item>\n    {% endblock %}\n{% endblock %}\n\n{% block sw_customer_list_delete_modal %}\n    {% parent() %}\n\n    {% block sw_customer_list_login_modal %}\n        <sw-customer-login-modal\n            v-if="loginCustomerId"\n            @close="onCloseLoginModal"\n            :customerId="loginCustomerId"\n        ></sw-customer-login-modal>\n    {% endblock %}\n{% endblock %}',data:function(){return{loginCustomerId:null}},methods:{onShowLoginModal:function(e){this.loginCustomerId=e},onCloseLoginModal:function(){this.loginCustomerId=null}}});var g=Shopware.Classes.ApiService,h=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&d(e,n)}(i,e);var n,t,o,r=f(i);function i(e,n){var t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"admin-login";return c(this,i),(t=r.call(this,e,n,o)).name="adminLoginApiService",t}return n=i,(t=[{key:"getToken",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r="/_action/admin-login/token",i=this.getBasicHeaders(o),s={customerId:e,salesChannelId:n};return this.httpClient.post(r,s,{additionalParams:t,headers:i}).then((function(e){return g.handleResponse(e)}))}}])&&u(n.prototype,t),o&&u(n,o),Object.defineProperty(n,"prototype",{writable:!1}),i}(g);Shopware.Service().register("adminLoginApiService",(function(e){var n=Shopware.Application.getContainer("init");return new h(n.httpClient,e.loginService)}))}});